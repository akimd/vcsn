#! /bin/sh

me=$(basename "$0")
medir=$(mktemp -d "/tmp/$me.XXXXXX") || exit 1

cat >$medir/symbols.txt <<\EOFSM
\e	0
a	1
c	2
child	3
d	4
e	5
g	6
grand	7
h	8
i	9
l	10
n	11
p	12
parent	13
r	14
t	15
EOFSM

cat >$medir/transitions.fsm <<\EOFSM
0	1	\e
0	2	\e
1	3	grand
2	4	\e
3	1	\e
3	2	\e
4	5	\e
4	6	\e
5	7	parent
6	8	child
7	9	\e
8	9	\e
9
EOFSM

fstcompile --acceptor \
  --keep_isymbols --isymbols=$medir/symbols.txt \
  --keep_osymbols --osymbols=$medir/symbols.txt \
  $medir/transitions.fsm "$@"
sta=$?

rm -rf $medir
exit $sta

