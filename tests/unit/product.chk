#! /bin/sh

## ---------------------- ##
## (a+b)* x (b+c)* = b*.  ##
## ---------------------- ##

run 0 '' -vcsn-standard-of -C 'lal_char(ab)_b' -e '(a+b)*' -o ab.dot
run 0 '' -vcsn-standard-of -C 'lal_char(bc)_b' -e '(b+c)*' -o bc.dot
run 0 - -vcsn-product -f ab.dot bc.dot <<EOF
digraph
{
  vcsn_context = "lal_char(b)_b"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
    F1
    F2
  }
  { 1 2 }
  I1 -> 1
  1 -> F1
  1 -> 2 [label = "b"]
  2 -> F2
  2 -> 2 [label = "b"]
}
EOF

## ------------- ##
## ab x cd = 0.  ##
## ------------- ##

run 0 '' -vcsn-standard-of -C 'lal_char(ab)_b' -e 'ab' -o ab.dot
run 0 '' -vcsn-standard-of -C 'lal_char(cd)_b' -e 'cd' -o bc.dot
run 0 - -vcsn-product -f ab.dot bc.dot <<EOF
digraph
{
  vcsn_context = "lal_char_b"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
  }
  { 1 }
  I1 -> 1
}
EOF



## ---------------------- ##
## (a+b)* x (c+d)* = \e.  ##
## ---------------------- ##

run 0 '' -vcsn-standard-of -C 'lal_char(ab)_b' -e '(a+b)*' -o ab.dot
run 0 '' -vcsn-standard-of -C 'lal_char(cd)_b' -e '(c+d)*' -o bc.dot
run 0 - -vcsn-product -f ab.dot bc.dot <<EOF
digraph
{
  vcsn_context = "lal_char_b"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
    F1
  }
  { 1 }
  I1 -> 1
  1 -> F1
}
EOF



## ------------ ##
## lal_char_z.  ##
## ------------ ##

# {2}(a*b*a*)
cat >a.dot <<\EOF
digraph
{
  vcsn_context = "lal_char(abc)_z"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
    F1
    F2
    F3
  }
  { 1 2 3 }
  I1 -> 1 [label = "{2}"]
  1 -> F1
  1 -> 1 [label = "a"]
  1 -> 2 [label = "b"]
  1 -> 3 [label = "a"]
  2 -> F2
  2 -> 2 [label = "b"]
  2 -> 3 [label = "a"]
  3 -> F3
  3 -> 3 [label = "a"]
}
EOF

# ({3}(ab))*
cat >b.dot <<\EOF
digraph
{
  vcsn_context = "lal_char(abc)_z"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
    F1
  }
  { 1 2 }
  I1 -> 1 [label = "{3}"]
  1 -> F1
  1 -> 2 [label = "a"]
  2 -> 1 [label = "{3}b"]
}
EOF

cat >out.exp <<\EOF
digraph
{
  vcsn_context = "lal_char(abc)_z"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I1
    F1
    F4
  }
  { 1 2 3 4 }
  I1 -> 1 [label = "{6}"]
  1 -> F1
  1 -> 2 [label = "a"]
  1 -> 3 [label = "a"]
  2 -> 4 [label = "{3}b"]
  4 -> F4
  4 -> 3 [label = "a"]
}
EOF

run 0 out.exp -vcsn-product -f a.dot b.dot
