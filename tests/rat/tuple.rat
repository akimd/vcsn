# We add useless letters (0-9) so that when printing [abcd], we
# display [a-d], not [^].
%context: lat<lan_char(abcd0-9), lan_char(efgh0-9), lan_char(ijkl0-9)>, q

\z|\z|\z => \z
\z|e|i   => \z
a|\z|i   => \z
a|e|\z   => \z

\e|\e|\e => \e
a|\e|\e  => a|\e|\e
\e|e|\e  => \e|e|\e
\e|\e|i  => \e|\e|i
a|\e|i   => a|\e|i

a|e|i                => a|e|i
a*|e*|i*             => a*|e*|i*
(a|e|i)*             => (a|e|i)*
a|e|i+b|f|j          => a|e|i+b|f|j
(a+b)|(e+f)|(i+j)    => (a+b)|(e+f)|(i+j)
[abcd]|[efgh]|[ijkl] => [a-d]|[e-h]|[i-l]
abcd|efgh|ijkl       => abcd|efgh|ijkl

a|e|i|z ! 1.6: too many tapes
a|e ! 1.1-3: not enough tapes: 2 expected 3
a ! 1.1: not enough tapes: 1 expected 3

%identities: linear
b|f|j+a|e|i          => a|e|i+b|f|j
(b+a)|(f+e)|(j+i)    => (a+b)|(e+f)|(i+j)

%context: lat<lan_char(abcd0-9), lan_char(efgh0-9), lan_char(ijkl0-9)>, q
abcd|efgh|ijkl       => abcd|efgh|ijkl
