#! /bin/sh

# check WEIGHT RAT-EXP
# --------------------
# Check that the constant-term of RAT-EXP is WEIGHT, and check that
# this is indeed the evaluation of the empty word on standard(RAT-EXP).
#
# Use a context with ratexp weights to check the order of products.
check ()
{
  local re
  re="(?@lal_char(abc)_ratexpset<lal_char(xyz)_z>)$2"
  run 0 "$1" -vcsn-constant-term -e "$re"
  run 0 "" -vcsn-standard -e "$re" -o a.gv
  run 0 "$1" -vcsn-evaluate -f a.gv ''
}

check '\z' 'a'
check '\e' 'a*'
check 'x' '<x>a*'

# Test zero.
check '\z' '<x>\z'

# Test one.
check 'x' '<x>\e'

# Test add.
check 'x+y' '<x>b*+<y>a*'
check 'x.(y+y).z' '<x>(<y>b*+<y>a*)<z>'

# Test mul.
check 'x.y' '<x>b*<y>a*'

# Test star.
check '\e' '(<x>a)*'
check 'x*' '(<x>\e)*'

# Test left and right weight.
check 'x.y*.z' '<x>(<y>\e)*<z>'
