#! /bin/sh

# check
# -----
check ()
{
  run 0 "$1" -vcsn-is-deterministic -A -f -
}

check "true" <<EOF
digraph
{
  vcsn_context = "lal_char(ab)_b"

  I1 -> 1
  1 -> 2 [label = "a"]
  1 -> 3 [label = "b"]
  2 -> 1 [label = "b"]
  3 -> 2 [label = "a"]
  3 -> 3 [label = "b"]
  2 -> F2
}
EOF


check "false" <<EOF
digraph
{
  vcsn_context = "lal_char(abc)_b"

  I1 -> 1
  1 -> 2 [label = "a"]
  1 -> 1 [label = "a"]
  2 -> 2 [label = "b"]
  2 -> 3 [label = "b"]
  3 -> 3 [label = "c"]
  3 -> F3
}
EOF


check "true" <<EOF
digraph
{
  vcsn_context = "lal_char(a)_b"

  I1 -> 1
  1 -> 2 [label = "a"]
  2 -> 3 [label = "a"]
  3 -> 4 [label = "a"]
  4 -> 5 [label = "a"]
  5 -> 6 [label = "a"]
  6 -> F6
}
EOF


check "true" <<EOF
digraph
{
  vcsn_context = "lal_char(ab)_b"

  I1 -> 1
  1 -> 2 [label = "a"]
  1 -> 3 [label = "b"]
  2 -> 4 [label = "a"]
  3 -> 4 [label = "b"]
  4 -> 4 [label = "a"]
  4 -> 4 [label = "b"]
  4 -> F4
}
EOF


check "false" <<EOF
digraph
{
  vcsn_context = "lal_char(abc)_b"

  I1 -> 1
  1 -> 2 [label = "a"]
  2 -> 2 [label = "b"]
  2 -> 3 [label = "c"]
  1 -> 4 [label = "c"]
  4 -> 4 [label = "c"]
  4 -> 3 [label = "c"]
  3 -> 5 [label = "a"]
  5 -> F5
}
EOF


check "true" <<EOF
digraph
{
  vcsn_context = "lal_char(ab)_b"

  I1 -> 1
  1 -> 2 [label = "b"]
  1 -> 3 [label = "a"]
  2 -> 3 [label = "a"]
  3 -> F3
}
EOF


check "false" <<EOF
digraph
{
  vcsn_context = "lal_char(a)_b"

  I1 -> 1
  I2 -> 2
  1 -> 3 [label = "a"]
  2 -> 3 [label = "a"]
  3 -> F3
}
EOF

