#! /bin/sh

## ----------- ##
## enumerate.  ##
## ----------- ##

## check_enumerate EXP MAX WORD...
## -------------------------------
## Check that EXP accepts WORD... has shortest words up to size MAX.
check_enumerate ()
{
  local exp=$1
  local max=$2
  shift 2
  for i
  do
    echo "$i"
  done >out.exp
  run 0 out.exp -vcsn-enumerate -Ee "$exp" "$max"
}


## check_shortest EXP NUM WORD...
## ------------------------------
## Check that EXP accepts WORD has shortest word, or throws if empty.
check_shortest ()
{
  local exp=$1
  local num=$2
  shift 2
  for i
  do
    echo "$i"
  done >out.exp
  run 0 out.exp -vcsn-shortest -O list -Ee "$exp" "$num"
}

## check EXP MAX WORD...
## ---------------------
## For the cases where enumerate and shortest give the same answers.
check ()
{
  check_enumerate "$@"
  check_shortest  "$@"
}


check '\z' 3
check '\e' 3 '\e'
check '(a+b)' 2 'a' 'b'
check 'ababab' 10 ababab

check_enumerate '(a+b)*' 2 '\e' 'a' 'b' aa ab ba bb
check_shortest  '(a+b)*' 2 '\e' 'a'

check_enumerate 'ababab' 2
check_shortest  'ababab' 2 'ababab'

check_enumerate '(?@lal_char(01)_z)(0+1)*1(<2>0+<2>1)*' 3 \
      '1' \
      '01' '<2>10' '<3>11' \
      '001' '<2>010' '<3>011' '<4>100' '<5>101' '<6>110' '<7>111'

check_shortest '(?@lal_char(01)_z)(0+1)*1(<2>0+<2>1)*' 3 \
      '1' \
      '01' '<2>10'

check '(?@lal_char(a)_z)a+<-1>a' 2
