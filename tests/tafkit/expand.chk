#! /bin/sh

# check_exp CONTEXT INPUT OUTPUT
# ------------------------------
check_exp ()
{
  run 0 $3 -vcsn expand -E -C "$1" -e "$2"
}

check_exp 'lal_char(abcd)_z'  '\z' '\z'
check_exp 'lal_char(abcd)_z'  '\e' '\e'
check_exp 'lal_char(abcd)_z'  a    a
check_exp 'lal_char(abcd)_z'  '<2>a'  '<2>a'
check_exp 'lal_char(abcd)_z'  'a+a'  '<2>a'
check_exp 'lal_char(abcd)_z'  'a+a'  '<2>a'
check_exp 'lal_char(abcd)_z'  'b+a+b+a'  '<2>a+<2>b'

check_exp 'lal_char(abcd)_z'  '(a*)&(b+a+b+a)'  '<2>(a*&a)+<2>(a*&b)'

check_exp 'lal_char(abcd)_z' \
  '<3>(b+a+b+a)<5>'  '<30>a+<30>b'

check_exp 'lal_char(abc)_z'  \
  '(a+b)?{3}' \
  '\e+<3>a+<3>b+<3>(aa)+<3>(ab)+<3>(ba)+<3>(bb)+aaa+aab+aba+abb+baa+bab+bba+bbb'

# TAF-Kit doc
check_exp 'lal_char(abcd)_z' \
  '(a+b+\e)((a+ba)(ca+cc))*' \
  '(aca+acc+baca+bacc)*+a(aca+acc+baca+bacc)*+b(aca+acc+baca+bacc)*'

check_exp 'lal_char(abcd)_z' \
  'a(b(c+a)*+c(b)*)+ac(\e+b)(b*)' \
  '<2>(acb*)+ab(a+c)*+acbb*'
