#! /bin/sh

check_aut ()
{
  cat >in.tmp
  sed -n '/^--*$/q;p'             in.tmp >in.gv
  sed -n '/^--*$/,${/^--*$/d;p;}' in.tmp >out.exp
  run 0 out.exp -vcsn-cat -Af in.gv "$@"
  $exit
}

check_aut -O grail <<\EOF
digraph
{
  vcsn_context = "lal_char(a)_b"
  0 -> 1 [label = a]
  1 -> F1
  I0 -> 0
}
---
(START) |- 0
0 a 1
1 -| (FINAL)
EOF

check_grail ()
{
  run 0 ignore -vcsn-ladybird -O grail -o grail.gr $1
  run 0 ignore -python -c "from FAdo import grail;grail.importFromGrailFile('grail.gr')"
}

check_grail 10
