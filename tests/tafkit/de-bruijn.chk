#! /bin/sh

# weighset VCSN-STANDARD-OF-ARGUMENTS
# -----------------------------------
weighset()
{
  while test $# != 0
  do
    case $1 in
      (-W) case $2 in
            (zr) echo 'ratexpset<lal_char(abcd)_z>';;
            (*) echo "$2";;
           esac
           return 0;;
      (-C) echo "$2"
           return 0;;
    esac
    shift
  done
  echo 'b'
  return 0
}

# check VCSN-STANDARD-OF-ARGUMENTS
# --------------------------------
# Expected output is on stdin, except the constant bits (see below).
check ()
{
  run 0 - -vcsn-de-bruijn "$@" -O dot
}

fail ()
{
  run 1 '' -vcsn-standard-of -C "$@"
}

check -C 'lal_char(ab)_b' 2 <<\EOF
digraph
{
  vcsn_context = "lal_char(ab)_b"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I0
    F3
  }
  { 0 1 2 3 }
  I0 -> 0
  0 -> 0 [label = "a, b"]
  0 -> 1 [label = "a"]
  1 -> 2 [label = "a, b"]
  2 -> 3 [label = "a, b"]
  3 -> F3
}
EOF

check -C 'lal_char(xyz)_b' 3 <<\EOF
digraph
{
  vcsn_context = "lal_char(xyz)_b"
  rankdir = LR
  node [shape = circle]
  {
    node [style = invis, shape = none, label = "", width = 0, height = 0]
    I0
    F4
  }
  { 0 1 2 3 4 }
  I0 -> 0
  0 -> 0 [label = "x, y, z"]
  0 -> 1 [label = "x"]
  1 -> 2 [label = "x, y, z"]
  2 -> 3 [label = "x, y, z"]
  3 -> 4 [label = "x, y, z"]
  4 -> F4
}
EOF
