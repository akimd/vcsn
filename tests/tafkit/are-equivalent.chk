#! /bin/sh

# check EXPECTED RAT1 RAT2
# ------------------------
# Check that are-equivalent(standard(RAT1), standard(RAT2)) == EXPECTED.
check ()
{
  run 0 stdout -vcsn-standard -e "$2" -o a1.gv
  run 0 stdout -vcsn-standard -e "$3" -o a2.gv
  case $1 in
    (true)  run 0 "$1" -vcsn-are-equivalent -A -f a1.gv a2.gv;;
    (false) run 2 "$1" -vcsn-are-equivalent -A -f a1.gv a2.gv;;
  esac
}

check true '\z' '\z'
check true '\e' '\e'
check true 'a' 'a'
check true 'ab' 'a.b'
check true 'a*' '\e+(a.(a*))'
check true 'a+b' 'b+a'
check true 'a*+a*+(\e+aa*)' 'a*'

check false '\z' '\e'
check false 'a' 'b'
check false 'ab' 'ba'
check false 'aa*' 'a*'
