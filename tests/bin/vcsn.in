#! @SHELL@
# @configure_input@
# Wrapper around a non installed vcsn to make it work as an installed one.

abs_srcdir='@abs_top_srcdir@'
export abs_srcdir
abs_builddir='@abs_top_builddir@'
export abs_builddir

# Where the instantiated contexts are generated and compiled.
VCSN_PLUGINDIR=$abs_builddir/lib/plugins
export VCSN_PLUGINDIR
test -d $VCSN_PLUGINDIR || mkdir -p $VCSN_PLUGINDIR

# Use the shipped files, not those installed.
VCSN_DATA_PATH=$abs_srcdir/share/vcsn
export VCSN_DATA_PATH

# Use the non-installed binaries.
PATH=$abs_builddir/bin:$abs_srcdir/bin:$PATH
export PATH

# Use the non-installed Python modules, and its libraries.
PYTHONPATH=$abs_srcdir/python:$abs_builddir/python:$abs_builddir/python/.libs:$PYTHONPATH
export PYTHONPATH
LD_LIBRARY_PATH=$abs_builddir/lib/.libs:$abs_builddir/python/.libs:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH
DYLD_LIBRARY_PATH=$abs_builddir/lib/.libs:$abs_builddir/python/.libs:$DYLD_LIBRARY_PATH
export DYLD_LIBRARY_PATH

# If we need to compile, use the non-installed headers and libs.
VCSN_CPPFLAGS="-I $abs_builddir -I $abs_srcdir @CPPFLAGS@"
export VCSN_CPPFLAGS
VCSN_LDFLAGS="-L $abs_builddir/lib/.libs @LDFLAGS@"
export VCSN_LDFLAGS

case $1 in
  ('') ;; # We are sourced to set up the environment.
  (-e) shift 1; exec "$@";;
  (*) # Hopefully not looping here, thanks to the change of PATH.
      exec vcsn "$@";;
esac

# Local Variables:
# mode: shell-script
# End:
