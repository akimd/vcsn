% -*- mode: latex; fill-column: 79; mode: auto-fill; mode: flyspell; buffer-file-coding-system: utf-8 -*-
\index{documentation}
\index{manual}
\index{manual!adding to}
The sources of this document reside in the \FILE{doc/manual/sources}
subdirectory of Vaucanson archives.

\index{\LaTeX{}}
The main \LaTeX{} source file is
\FILE{doc/manual/sources/vaucanson-manual.tex}, which in its turn
\verb!\input!s other files --- usually, but not necessarily, one per
chapter.

\section{Including IPython notebooks}
The documentation build system includes a facility automatically converting
IPython notebook files into \LaTeX{} documents, particularly convenient for
chapters or sections containing many examples: for them to be accessible the
user only needs to include notebook files (or links to them) in the
\FILE{doc/manual/sources/notebooks} subdirectory.  The build system will
convert each notebook into a \LaTeX{} file, on which other \LaTeX{} files can
freely use \verb!\input! or \verb!\include!.

In order to be more friendly to \LaTeX (and Unix), an IPython notebook
file with extension \FILE{.ipynb} is automatically translated into a
\LaTeX{} file with extension \FILE{.tex}, \textit{and with every space
  and underscore in its name replaced by a dash}.

For example \FILE{doc/manual/sources/notebooks/} contains a symbolic
link named \FILE{Graph~operations.ipynb}, making up the source of
ยง\ref{graph-operations}: that is automatically translated into
\FILE{Graph-operations.tex}; the file happens to be used directly from
the main documentation source \FILE{vaucanson-manual.tex}, which
contains the following line:
\begin{verbatim}
\input{Graph-operations}
\end{verbatim}
As shown in the line above, the user should not specify a directory
when referring a translated notebook file.

\index{heading} An IPython notebook translated into \LaTeX{} does not
necessarily constitute a distinct chapter and in fact does not include, by
default, any chapter or section heading.  This permits to use translated
notebooks even for single examples, to be included within chapters entirely
hand-written in \LaTeX{}.

\subsection{IPython notebook markup extension}
A notebook to be translated into \LaTeX{} will usually consist in some
combination of Python expressions with their evaluated results, and
\index{Markdown}
text with \textit{Markdown}\footnote{An informal specification is
  available at \url{http://daringfireball.net/projects/markdown/}.
  The Wikipedia page \url{http://en.wikipedia.org/wiki/Markdown}
  contains some further information.}
markup.

We implemented a minor extension to the Markdown language by allowing
the user to add an \textit{index entry} for the manual in Markdown
comments starting with a capital \CODE{I} character \textit{not} preceded by
  spaces, such as ``\CODE{<!--I \emph{entry}-->}''.  There has to be no space
  between ``\CODE{<!--}'' and ``\CODE{I}'' for the comment to be taken into
  account as an index entry.

For example a notebook could contain the following Markdown text in a cell:
\begin{verbatim}
<!--I determinization -->
<!--I determinization!weighted -->
Determinization of weighted automata is not always possible.
\end{verbatim}
which will generate the \LaTeX{} code:
\begin{verbatim}
\index{determinization}
\index{determinization!weighted}
Determinization of weighted automata is not always possible.
\end{verbatim}

The included index entry is allowed to contain arbitrary \LaTeX{}
code including math and macro calls, as in:
\begin{verbatim}
\input{<!--I $\pi$ -->}
\end{verbatim}

\index{script}
\index{compile-manual}
\index{\CODE{nbconvert}}
\index{\CODE{ipython}!\CODE{nbconvert}}
The bulk of the translation from IPython notebooks to \LaTeX{} is implemented
in the \CODE{ipython nbconvert} tool.  The Vaucanson source code
includes the script \FILE{doc/manual/compile-manual} to automatically
invoke it and then patch its output.  As the script is reasonably simple
and well-commented it can be extended to support more Markdown comment
extensions in the future.

\section{Building}
\index{make}
The PDF manual is generated by the \CODE{manual} target: assuming that
Vaucanson has been configured to be built in its source directory as
recommended in ยง\ref{assume-we-build-in-the-source-directory}, the
following command line from the source directory will regenerate it:\
\begin{verbatim}
$ make manual
\end{verbatim}
The subdirectory \FILE{doc/manual/scratch} is used for temporary
files.

\index{build directory}
\index{source directory}
\index{make}
Documentation is currently generated under the \textit{source}
directory, which will be noticeable to users configuring from a
different \textit{build} directory.
\\\\
Vaucanson tarballs include a pre-compiled PDF manual along with the sources.
